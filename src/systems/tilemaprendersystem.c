/* tilemaprendersystem.c generated by valac 0.32.0, the Vala compiler
 * generated from tilemaprendersystem.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <engine.h>
#include <SDL2/SDL_render.h>
#include <gee.h>
#include <gxml/gxml.h>
#include <tiled.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <SDL2/SDL_rect.h>


#define TYPE_TILEMAP_RENDER_SYSTEM (tilemap_render_system_get_type ())
#define TILEMAP_RENDER_SYSTEM(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TILEMAP_RENDER_SYSTEM, TilemapRenderSystem))
#define TILEMAP_RENDER_SYSTEM_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TILEMAP_RENDER_SYSTEM, TilemapRenderSystemClass))
#define IS_TILEMAP_RENDER_SYSTEM(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TILEMAP_RENDER_SYSTEM))
#define IS_TILEMAP_RENDER_SYSTEM_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TILEMAP_RENDER_SYSTEM))
#define TILEMAP_RENDER_SYSTEM_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TILEMAP_RENDER_SYSTEM, TilemapRenderSystemClass))

typedef struct _TilemapRenderSystem TilemapRenderSystem;
typedef struct _TilemapRenderSystemClass TilemapRenderSystemClass;
typedef struct _TilemapRenderSystemPrivate TilemapRenderSystemPrivate;

#define TYPE_TEXTURE_MANAGER (texture_manager_get_type ())
#define TEXTURE_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TEXTURE_MANAGER, TextureManager))
#define TEXTURE_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TEXTURE_MANAGER, TextureManagerClass))
#define IS_TEXTURE_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TEXTURE_MANAGER))
#define IS_TEXTURE_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TEXTURE_MANAGER))
#define TEXTURE_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TEXTURE_MANAGER, TextureManagerClass))

typedef struct _TextureManager TextureManager;
typedef struct _TextureManagerClass TextureManagerClass;

#define TYPE_CAMERA (camera_get_type ())
#define CAMERA(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_CAMERA, Camera))
#define CAMERA_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_CAMERA, CameraClass))
#define IS_CAMERA(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_CAMERA))
#define IS_CAMERA_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_CAMERA))
#define CAMERA_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_CAMERA, CameraClass))

typedef struct _Camera Camera;
typedef struct _CameraClass CameraClass;

#define TYPE_TILEMAP_COMPONENT2 (tilemap_component2_get_type ())
#define TILEMAP_COMPONENT2(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TILEMAP_COMPONENT2, TilemapComponent2))
#define TILEMAP_COMPONENT2_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TILEMAP_COMPONENT2, TilemapComponent2Class))
#define IS_TILEMAP_COMPONENT2(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TILEMAP_COMPONENT2))
#define IS_TILEMAP_COMPONENT2_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TILEMAP_COMPONENT2))
#define TILEMAP_COMPONENT2_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TILEMAP_COMPONENT2, TilemapComponent2Class))

typedef struct _TilemapComponent2 TilemapComponent2;
typedef struct _TilemapComponent2Class TilemapComponent2Class;
typedef struct _TilemapComponent2Private TilemapComponent2Private;

#define TYPE_TEXTURE (texture_get_type ())
#define TEXTURE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TEXTURE, Texture))
#define TEXTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TEXTURE, TextureClass))
#define IS_TEXTURE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TEXTURE))
#define IS_TEXTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TEXTURE))
#define TEXTURE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TEXTURE, TextureClass))

typedef struct _Texture Texture;
typedef struct _TextureClass TextureClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

struct _TilemapRenderSystem {
	EngineEntitySystem parent_instance;
	TilemapRenderSystemPrivate * priv;
};

struct _TilemapRenderSystemClass {
	EngineEntitySystemClass parent_class;
};

struct _TilemapRenderSystemPrivate {
	SDL_Renderer* renderer;
	TextureManager* textureManager;
	Camera* camera;
	gboolean loaded;
};

struct _TilemapComponent2 {
	EngineComponent parent_instance;
	TilemapComponent2Private * priv;
	TiledMap* map;
};

struct _TilemapComponent2Class {
	EngineComponentClass parent_class;
};


static gpointer tilemap_render_system_parent_class = NULL;

GType tilemap_render_system_get_type (void) G_GNUC_CONST;
GType texture_manager_get_type (void) G_GNUC_CONST;
gpointer camera_ref (gpointer instance);
void camera_unref (gpointer instance);
GParamSpec* param_spec_camera (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void value_set_camera (GValue* value, gpointer v_object);
void value_take_camera (GValue* value, gpointer v_object);
gpointer value_get_camera (const GValue* value);
GType camera_get_type (void) G_GNUC_CONST;
#define TILEMAP_RENDER_SYSTEM_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_TILEMAP_RENDER_SYSTEM, TilemapRenderSystemPrivate))
enum  {
	TILEMAP_RENDER_SYSTEM_DUMMY_PROPERTY
};
TilemapRenderSystem* tilemap_render_system_new (Camera* camera, SDL_Renderer* renderer, TextureManager* textureManager);
TilemapRenderSystem* tilemap_render_system_construct (GType object_type, Camera* camera, SDL_Renderer* renderer, TextureManager* textureManager);
void tilemap_render_system_loadTexture (TilemapRenderSystem* self);
GType tilemap_component2_get_type (void) G_GNUC_CONST;
GType texture_get_type (void) G_GNUC_CONST;
Texture* texture_manager_load (TextureManager* self, const gchar* identifier, const gchar* filename, SDL_Renderer* renderer);
static GType* tilemap_render_system_real_getEntityTypes (EngineEntitySystem* base, int* result_length1);
static void tilemap_render_system_real_update (EngineSystem* base, gfloat deltaTime);
static void tilemap_render_system_render_map (TilemapRenderSystem* self, TilemapComponent2* c);
gint camera_get_x (Camera* self);
void texture_manager_draw_frame (TextureManager* self, const gchar* identifier, SDL_Rect* dst, gint row, gint column, SDL_RendererFlip flip, SDL_Renderer* renderer);
static void tilemap_render_system_finalize (GObject* obj);


TilemapRenderSystem* tilemap_render_system_construct (GType object_type, Camera* camera, SDL_Renderer* renderer, TextureManager* textureManager) {
	TilemapRenderSystem * self = NULL;
	Camera* _tmp0_ = NULL;
	SDL_Renderer* _tmp1_ = NULL;
	TextureManager* _tmp2_ = NULL;
	g_return_val_if_fail (camera != NULL, NULL);
	g_return_val_if_fail (renderer != NULL, NULL);
	g_return_val_if_fail (textureManager != NULL, NULL);
	self = (TilemapRenderSystem*) engine_entity_system_construct (object_type);
	_tmp0_ = camera;
	self->priv->camera = _tmp0_;
	_tmp1_ = renderer;
	self->priv->renderer = _tmp1_;
	_tmp2_ = textureManager;
	self->priv->textureManager = _tmp2_;
	return self;
}


TilemapRenderSystem* tilemap_render_system_new (Camera* camera, SDL_Renderer* renderer, TextureManager* textureManager) {
	return tilemap_render_system_construct (TYPE_TILEMAP_RENDER_SYSTEM, camera, renderer, textureManager);
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


void tilemap_render_system_loadTexture (TilemapRenderSystem* self) {
	g_return_if_fail (self != NULL);
	{
		GeeList* _e_list = NULL;
		GeeList* _tmp0_ = NULL;
		GeeList* _tmp1_ = NULL;
		gint _e_size = 0;
		GeeList* _tmp2_ = NULL;
		gint _tmp3_ = 0;
		gint _tmp4_ = 0;
		gint _e_index = 0;
		_tmp0_ = ((EngineEntitySystem*) self)->entities;
		_tmp1_ = _g_object_ref0 (_tmp0_);
		_e_list = _tmp1_;
		_tmp2_ = _e_list;
		_tmp3_ = gee_collection_get_size ((GeeCollection*) _tmp2_);
		_tmp4_ = _tmp3_;
		_e_size = _tmp4_;
		_e_index = -1;
		while (TRUE) {
			gint _tmp5_ = 0;
			gint _tmp6_ = 0;
			gint _tmp7_ = 0;
			EngineEntity* e = NULL;
			GeeList* _tmp8_ = NULL;
			gint _tmp9_ = 0;
			gpointer _tmp10_ = NULL;
			TilemapComponent2* c = NULL;
			EngineEntity* _tmp11_ = NULL;
			gpointer _tmp12_ = NULL;
			_tmp5_ = _e_index;
			_e_index = _tmp5_ + 1;
			_tmp6_ = _e_index;
			_tmp7_ = _e_size;
			if (!(_tmp6_ < _tmp7_)) {
				break;
			}
			_tmp8_ = _e_list;
			_tmp9_ = _e_index;
			_tmp10_ = gee_list_get (_tmp8_, _tmp9_);
			e = (EngineEntity*) _tmp10_;
			_tmp11_ = e;
			_tmp12_ = engine_entity_get_component (_tmp11_, TYPE_TILEMAP_COMPONENT2, (GBoxedCopyFunc) g_object_ref, g_object_unref);
			c = (TilemapComponent2*) _tmp12_;
			{
				GXmlSerializableArrayList* _ts_list = NULL;
				TilemapComponent2* _tmp13_ = NULL;
				TiledMap* _tmp14_ = NULL;
				GXmlSerializableArrayList* _tmp15_ = NULL;
				GXmlSerializableArrayList* _tmp16_ = NULL;
				GXmlSerializableArrayList* _tmp17_ = NULL;
				gint _ts_size = 0;
				GXmlSerializableArrayList* _tmp18_ = NULL;
				gint _tmp19_ = 0;
				gint _tmp20_ = 0;
				gint _ts_index = 0;
				_tmp13_ = c;
				_tmp14_ = _tmp13_->map;
				_tmp15_ = tiled_map_get_tileset (_tmp14_);
				_tmp16_ = _tmp15_;
				_tmp17_ = _g_object_ref0 (_tmp16_);
				_ts_list = _tmp17_;
				_tmp18_ = _ts_list;
				_tmp19_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp18_);
				_tmp20_ = _tmp19_;
				_ts_size = _tmp20_;
				_ts_index = -1;
				while (TRUE) {
					gint _tmp21_ = 0;
					gint _tmp22_ = 0;
					gint _tmp23_ = 0;
					TiledTileset* ts = NULL;
					GXmlSerializableArrayList* _tmp24_ = NULL;
					gint _tmp25_ = 0;
					gpointer _tmp26_ = NULL;
					TextureManager* _tmp27_ = NULL;
					TiledTileset* _tmp28_ = NULL;
					const gchar* _tmp29_ = NULL;
					const gchar* _tmp30_ = NULL;
					TiledTileset* _tmp31_ = NULL;
					TiledImage* _tmp32_ = NULL;
					TiledImage* _tmp33_ = NULL;
					const gchar* _tmp34_ = NULL;
					const gchar* _tmp35_ = NULL;
					gchar* _tmp36_ = NULL;
					gchar* _tmp37_ = NULL;
					SDL_Renderer* _tmp38_ = NULL;
					Texture* _tmp39_ = NULL;
					Texture* _tmp40_ = NULL;
					_tmp21_ = _ts_index;
					_ts_index = _tmp21_ + 1;
					_tmp22_ = _ts_index;
					_tmp23_ = _ts_size;
					if (!(_tmp22_ < _tmp23_)) {
						break;
					}
					_tmp24_ = _ts_list;
					_tmp25_ = _ts_index;
					_tmp26_ = gee_abstract_list_get ((GeeAbstractList*) _tmp24_, _tmp25_);
					ts = (TiledTileset*) _tmp26_;
					_tmp27_ = self->priv->textureManager;
					_tmp28_ = ts;
					_tmp29_ = tiled_tileset_get_name (_tmp28_);
					_tmp30_ = _tmp29_;
					_tmp31_ = ts;
					_tmp32_ = tiled_tileset_get_image (_tmp31_);
					_tmp33_ = _tmp32_;
					_tmp34_ = tiled_image_get_source (_tmp33_);
					_tmp35_ = _tmp34_;
					_tmp36_ = g_strconcat ("data/", _tmp35_, NULL);
					_tmp37_ = _tmp36_;
					_tmp38_ = self->priv->renderer;
					_tmp39_ = texture_manager_load (_tmp27_, _tmp30_, _tmp37_, _tmp38_);
					_tmp40_ = _tmp39_;
					_g_object_unref0 (_tmp40_);
					_g_free0 (_tmp37_);
					_g_object_unref0 (ts);
				}
				_g_object_unref0 (_ts_list);
			}
			_g_object_unref0 (c);
			_g_object_unref0 (e);
		}
		_g_object_unref0 (_e_list);
	}
}


static GType* tilemap_render_system_real_getEntityTypes (EngineEntitySystem* base, int* result_length1) {
	TilemapRenderSystem * self;
	GType* result = NULL;
	GType* _tmp0_ = NULL;
	GType* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	self = (TilemapRenderSystem*) base;
	_tmp0_ = g_new0 (GType, 1);
	_tmp0_[0] = TYPE_TILEMAP_COMPONENT2;
	_tmp1_ = _tmp0_;
	_tmp1__length1 = 1;
	if (result_length1) {
		*result_length1 = _tmp1__length1;
	}
	result = _tmp1_;
	return result;
}


static void tilemap_render_system_real_update (EngineSystem* base, gfloat deltaTime) {
	TilemapRenderSystem * self;
	gboolean _tmp0_ = FALSE;
	self = (TilemapRenderSystem*) base;
	_tmp0_ = self->priv->loaded;
	if (!_tmp0_) {
		tilemap_render_system_loadTexture (self);
		self->priv->loaded = TRUE;
	}
	{
		GeeList* _e_list = NULL;
		GeeList* _tmp1_ = NULL;
		GeeList* _tmp2_ = NULL;
		gint _e_size = 0;
		GeeList* _tmp3_ = NULL;
		gint _tmp4_ = 0;
		gint _tmp5_ = 0;
		gint _e_index = 0;
		_tmp1_ = ((EngineEntitySystem*) self)->entities;
		_tmp2_ = _g_object_ref0 (_tmp1_);
		_e_list = _tmp2_;
		_tmp3_ = _e_list;
		_tmp4_ = gee_collection_get_size ((GeeCollection*) _tmp3_);
		_tmp5_ = _tmp4_;
		_e_size = _tmp5_;
		_e_index = -1;
		while (TRUE) {
			gint _tmp6_ = 0;
			gint _tmp7_ = 0;
			gint _tmp8_ = 0;
			EngineEntity* e = NULL;
			GeeList* _tmp9_ = NULL;
			gint _tmp10_ = 0;
			gpointer _tmp11_ = NULL;
			TilemapComponent2* c = NULL;
			EngineEntity* _tmp12_ = NULL;
			gpointer _tmp13_ = NULL;
			TilemapComponent2* _tmp14_ = NULL;
			_tmp6_ = _e_index;
			_e_index = _tmp6_ + 1;
			_tmp7_ = _e_index;
			_tmp8_ = _e_size;
			if (!(_tmp7_ < _tmp8_)) {
				break;
			}
			_tmp9_ = _e_list;
			_tmp10_ = _e_index;
			_tmp11_ = gee_list_get (_tmp9_, _tmp10_);
			e = (EngineEntity*) _tmp11_;
			_tmp12_ = e;
			_tmp13_ = engine_entity_get_component (_tmp12_, TYPE_TILEMAP_COMPONENT2, (GBoxedCopyFunc) g_object_ref, g_object_unref);
			c = (TilemapComponent2*) _tmp13_;
			_tmp14_ = c;
			tilemap_render_system_render_map (self, _tmp14_);
			_g_object_unref0 (c);
			_g_object_unref0 (e);
		}
		_g_object_unref0 (_e_list);
	}
}


static void tilemap_render_system_render_map (TilemapRenderSystem* self, TilemapComponent2* c) {
	g_return_if_fail (self != NULL);
	g_return_if_fail (c != NULL);
	{
		gint i = 0;
		i = 0;
		{
			gboolean _tmp0_ = FALSE;
			_tmp0_ = TRUE;
			while (TRUE) {
				gint _tmp2_ = 0;
				TilemapComponent2* _tmp3_ = NULL;
				TiledMap* _tmp4_ = NULL;
				gint _tmp5_ = 0;
				gint _tmp6_ = 0;
				if (!_tmp0_) {
					gint _tmp1_ = 0;
					_tmp1_ = i;
					i = _tmp1_ + 1;
				}
				_tmp0_ = FALSE;
				_tmp2_ = i;
				_tmp3_ = c;
				_tmp4_ = _tmp3_->map;
				_tmp5_ = tiled_map_get_height (_tmp4_);
				_tmp6_ = _tmp5_;
				if (!(_tmp2_ < _tmp6_)) {
					break;
				}
				{
					gint j = 0;
					j = 0;
					{
						gboolean _tmp7_ = FALSE;
						_tmp7_ = TRUE;
						while (TRUE) {
							gint _tmp9_ = 0;
							TilemapComponent2* _tmp10_ = NULL;
							TiledMap* _tmp11_ = NULL;
							gint _tmp12_ = 0;
							gint _tmp13_ = 0;
							gint tilenumber = 0;
							gint _tmp14_ = 0;
							gint _tmp15_ = 0;
							TilemapComponent2* _tmp16_ = NULL;
							TiledMap* _tmp17_ = NULL;
							gint _tmp18_ = 0;
							gint _tmp19_ = 0;
							SDL_Rect dst = {0};
							gint _tmp20_ = 0;
							TilemapComponent2* _tmp21_ = NULL;
							TiledMap* _tmp22_ = NULL;
							gint _tmp23_ = 0;
							gint _tmp24_ = 0;
							Camera* _tmp25_ = NULL;
							gint _tmp26_ = 0;
							gint _tmp27_ = 0;
							gint _tmp28_ = 0;
							TilemapComponent2* _tmp29_ = NULL;
							TiledMap* _tmp30_ = NULL;
							gint _tmp31_ = 0;
							gint _tmp32_ = 0;
							TilemapComponent2* _tmp33_ = NULL;
							TiledMap* _tmp34_ = NULL;
							gint _tmp35_ = 0;
							gint _tmp36_ = 0;
							TilemapComponent2* _tmp37_ = NULL;
							TiledMap* _tmp38_ = NULL;
							gint _tmp39_ = 0;
							gint _tmp40_ = 0;
							SDL_Rect _tmp41_ = {0};
							gint row = 0;
							TilemapComponent2* _tmp42_ = NULL;
							TiledMap* _tmp43_ = NULL;
							GXmlSerializableArrayList* _tmp44_ = NULL;
							GXmlSerializableArrayList* _tmp45_ = NULL;
							gpointer _tmp46_ = NULL;
							TiledLayer* _tmp47_ = NULL;
							TiledData* _tmp48_ = NULL;
							TiledData* _tmp49_ = NULL;
							GXmlSerializableArrayList* _tmp50_ = NULL;
							GXmlSerializableArrayList* _tmp51_ = NULL;
							gint _tmp52_ = 0;
							gpointer _tmp53_ = NULL;
							TiledTile* _tmp54_ = NULL;
							gint _tmp55_ = 0;
							gint _tmp56_ = 0;
							TilemapComponent2* _tmp57_ = NULL;
							TiledMap* _tmp58_ = NULL;
							GXmlSerializableArrayList* _tmp59_ = NULL;
							GXmlSerializableArrayList* _tmp60_ = NULL;
							gpointer _tmp61_ = NULL;
							TiledTileset* _tmp62_ = NULL;
							gint _tmp63_ = 0;
							gint _tmp64_ = 0;
							gint _tmp65_ = 0;
							gint column = 0;
							TilemapComponent2* _tmp66_ = NULL;
							TiledMap* _tmp67_ = NULL;
							GXmlSerializableArrayList* _tmp68_ = NULL;
							GXmlSerializableArrayList* _tmp69_ = NULL;
							gpointer _tmp70_ = NULL;
							TiledLayer* _tmp71_ = NULL;
							TiledData* _tmp72_ = NULL;
							TiledData* _tmp73_ = NULL;
							GXmlSerializableArrayList* _tmp74_ = NULL;
							GXmlSerializableArrayList* _tmp75_ = NULL;
							gint _tmp76_ = 0;
							gpointer _tmp77_ = NULL;
							TiledTile* _tmp78_ = NULL;
							gint _tmp79_ = 0;
							gint _tmp80_ = 0;
							TilemapComponent2* _tmp81_ = NULL;
							TiledMap* _tmp82_ = NULL;
							GXmlSerializableArrayList* _tmp83_ = NULL;
							GXmlSerializableArrayList* _tmp84_ = NULL;
							gpointer _tmp85_ = NULL;
							TiledTileset* _tmp86_ = NULL;
							gint _tmp87_ = 0;
							gint _tmp88_ = 0;
							gint _tmp89_ = 0;
							TextureManager* _tmp90_ = NULL;
							TilemapComponent2* _tmp91_ = NULL;
							TiledMap* _tmp92_ = NULL;
							GXmlSerializableArrayList* _tmp93_ = NULL;
							GXmlSerializableArrayList* _tmp94_ = NULL;
							gpointer _tmp95_ = NULL;
							TiledTileset* _tmp96_ = NULL;
							const gchar* _tmp97_ = NULL;
							const gchar* _tmp98_ = NULL;
							SDL_Rect _tmp99_ = {0};
							gint _tmp100_ = 0;
							gint _tmp101_ = 0;
							SDL_Renderer* _tmp102_ = NULL;
							if (!_tmp7_) {
								gint _tmp8_ = 0;
								_tmp8_ = j;
								j = _tmp8_ + 1;
							}
							_tmp7_ = FALSE;
							_tmp9_ = j;
							_tmp10_ = c;
							_tmp11_ = _tmp10_->map;
							_tmp12_ = tiled_map_get_width (_tmp11_);
							_tmp13_ = _tmp12_;
							if (!(_tmp9_ < _tmp13_)) {
								break;
							}
							_tmp14_ = j;
							_tmp15_ = i;
							_tmp16_ = c;
							_tmp17_ = _tmp16_->map;
							_tmp18_ = tiled_map_get_width (_tmp17_);
							_tmp19_ = _tmp18_;
							tilenumber = _tmp14_ + (_tmp15_ * _tmp19_);
							_tmp20_ = j;
							_tmp21_ = c;
							_tmp22_ = _tmp21_->map;
							_tmp23_ = tiled_map_get_tilewidth (_tmp22_);
							_tmp24_ = _tmp23_;
							_tmp25_ = self->priv->camera;
							_tmp26_ = camera_get_x (_tmp25_);
							_tmp27_ = _tmp26_;
							_tmp28_ = i;
							_tmp29_ = c;
							_tmp30_ = _tmp29_->map;
							_tmp31_ = tiled_map_get_tileheight (_tmp30_);
							_tmp32_ = _tmp31_;
							_tmp33_ = c;
							_tmp34_ = _tmp33_->map;
							_tmp35_ = tiled_map_get_tilewidth (_tmp34_);
							_tmp36_ = _tmp35_;
							_tmp37_ = c;
							_tmp38_ = _tmp37_->map;
							_tmp39_ = tiled_map_get_tileheight (_tmp38_);
							_tmp40_ = _tmp39_;
							memset (&_tmp41_, 0, sizeof (SDL_Rect));
							_tmp41_.x = (_tmp20_ * _tmp24_) - _tmp27_;
							_tmp41_.y = _tmp28_ * _tmp32_;
							_tmp41_.w = (guint) _tmp36_;
							_tmp41_.h = (guint) _tmp40_;
							dst = _tmp41_;
							_tmp42_ = c;
							_tmp43_ = _tmp42_->map;
							_tmp44_ = tiled_map_get_layer (_tmp43_);
							_tmp45_ = _tmp44_;
							_tmp46_ = gee_abstract_list_get ((GeeAbstractList*) _tmp45_, 0);
							_tmp47_ = (TiledLayer*) _tmp46_;
							_tmp48_ = tiled_layer_get_data (_tmp47_);
							_tmp49_ = _tmp48_;
							_tmp50_ = tiled_data_get_tiles (_tmp49_);
							_tmp51_ = _tmp50_;
							_tmp52_ = tilenumber;
							_tmp53_ = gee_abstract_list_get ((GeeAbstractList*) _tmp51_, _tmp52_);
							_tmp54_ = (TiledTile*) _tmp53_;
							_tmp55_ = tiled_tile_get_gid (_tmp54_);
							_tmp56_ = _tmp55_;
							_tmp57_ = c;
							_tmp58_ = _tmp57_->map;
							_tmp59_ = tiled_map_get_tileset (_tmp58_);
							_tmp60_ = _tmp59_;
							_tmp61_ = gee_abstract_list_get ((GeeAbstractList*) _tmp60_, 0);
							_tmp62_ = (TiledTileset*) _tmp61_;
							_tmp63_ = tiled_tileset_get_columns (_tmp62_);
							_tmp64_ = _tmp63_;
							_tmp65_ = _tmp56_ / _tmp64_;
							_g_object_unref0 (_tmp62_);
							_g_object_unref0 (_tmp54_);
							_g_object_unref0 (_tmp47_);
							row = _tmp65_;
							_tmp66_ = c;
							_tmp67_ = _tmp66_->map;
							_tmp68_ = tiled_map_get_layer (_tmp67_);
							_tmp69_ = _tmp68_;
							_tmp70_ = gee_abstract_list_get ((GeeAbstractList*) _tmp69_, 0);
							_tmp71_ = (TiledLayer*) _tmp70_;
							_tmp72_ = tiled_layer_get_data (_tmp71_);
							_tmp73_ = _tmp72_;
							_tmp74_ = tiled_data_get_tiles (_tmp73_);
							_tmp75_ = _tmp74_;
							_tmp76_ = tilenumber;
							_tmp77_ = gee_abstract_list_get ((GeeAbstractList*) _tmp75_, _tmp76_);
							_tmp78_ = (TiledTile*) _tmp77_;
							_tmp79_ = tiled_tile_get_gid (_tmp78_);
							_tmp80_ = _tmp79_;
							_tmp81_ = c;
							_tmp82_ = _tmp81_->map;
							_tmp83_ = tiled_map_get_tileset (_tmp82_);
							_tmp84_ = _tmp83_;
							_tmp85_ = gee_abstract_list_get ((GeeAbstractList*) _tmp84_, 0);
							_tmp86_ = (TiledTileset*) _tmp85_;
							_tmp87_ = tiled_tileset_get_columns (_tmp86_);
							_tmp88_ = _tmp87_;
							_tmp89_ = (_tmp80_ % _tmp88_) - 1;
							_g_object_unref0 (_tmp86_);
							_g_object_unref0 (_tmp78_);
							_g_object_unref0 (_tmp71_);
							column = _tmp89_;
							_tmp90_ = self->priv->textureManager;
							_tmp91_ = c;
							_tmp92_ = _tmp91_->map;
							_tmp93_ = tiled_map_get_tileset (_tmp92_);
							_tmp94_ = _tmp93_;
							_tmp95_ = gee_abstract_list_get ((GeeAbstractList*) _tmp94_, 0);
							_tmp96_ = (TiledTileset*) _tmp95_;
							_tmp97_ = tiled_tileset_get_name (_tmp96_);
							_tmp98_ = _tmp97_;
							_tmp99_ = dst;
							_tmp100_ = row;
							_tmp101_ = column;
							_tmp102_ = self->priv->renderer;
							texture_manager_draw_frame (_tmp90_, _tmp98_, &_tmp99_, _tmp100_, _tmp101_, SDL_FLIP_NONE, _tmp102_);
							_g_object_unref0 (_tmp96_);
						}
					}
				}
			}
		}
	}
}


static void tilemap_render_system_class_init (TilemapRenderSystemClass * klass) {
	tilemap_render_system_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (TilemapRenderSystemPrivate));
	((EngineEntitySystemClass *) klass)->getEntityTypes = tilemap_render_system_real_getEntityTypes;
	((EngineSystemClass *) klass)->update = tilemap_render_system_real_update;
	G_OBJECT_CLASS (klass)->finalize = tilemap_render_system_finalize;
}


static void tilemap_render_system_instance_init (TilemapRenderSystem * self) {
	self->priv = TILEMAP_RENDER_SYSTEM_GET_PRIVATE (self);
	self->priv->loaded = FALSE;
}


static void tilemap_render_system_finalize (GObject* obj) {
	TilemapRenderSystem * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, TYPE_TILEMAP_RENDER_SYSTEM, TilemapRenderSystem);
	G_OBJECT_CLASS (tilemap_render_system_parent_class)->finalize (obj);
}


GType tilemap_render_system_get_type (void) {
	static volatile gsize tilemap_render_system_type_id__volatile = 0;
	if (g_once_init_enter (&tilemap_render_system_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (TilemapRenderSystemClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) tilemap_render_system_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (TilemapRenderSystem), 0, (GInstanceInitFunc) tilemap_render_system_instance_init, NULL };
		GType tilemap_render_system_type_id;
		tilemap_render_system_type_id = g_type_register_static (ENGINE_TYPE_ENTITY_SYSTEM, "TilemapRenderSystem", &g_define_type_info, 0);
		g_once_init_leave (&tilemap_render_system_type_id__volatile, tilemap_render_system_type_id);
	}
	return tilemap_render_system_type_id__volatile;
}



